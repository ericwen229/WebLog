<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>WebLog Console</title>
		<link rel="stylesheet" type="text/css" href="style.css" />
	</head>
	<body>
		<div id="logContainer">
			<pre id="logContent"></pre>
		</div>
		<script src="jquery-3.2.1.min.js"></script>
		<script src="/socket.io/socket.io.js"></script>
		<script>
			function loadData() {
				$.ajax({
					url: "/api/logs",
					method: "GET",
					dataType: "json",
				}).done(function(json) {
					$.each(json.data, function(index, item) {
						$("#logContent").append(item);
					});
					registerUpdate();
				});
			}
			function registerUpdate() {
				var socket = io();
				socket.on('logUpdate', function(log) {
					$('#logContent').append(log);
				});
			}
			$(document).ready(function() {
				loadData();
			});
		</script>
	</body>
</html>
